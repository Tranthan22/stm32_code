#include "http.h"

extern const uint8_t macaddr[6];
extern const uint8_t ip[4];
extern char debug_string[60];

uint8_t status=0;
uint32_t data_num=0;
uint32_t Sequence_Number=0;

const uint8_t web_page[]=
{
 0x48 ,0x54 ,0x54 ,0x50 ,0x2f ,0x31 ,0x2e ,0x31 ,0x20 ,0x32 ,0x30 ,0x30 ,0x20 ,0x4f ,0x4b ,0x0a
,0x43 ,0x6f ,0x6e ,0x74 ,0x65 ,0x6e ,0x74 ,0x2d ,0x54 ,0x79 ,0x70 ,0x65 ,0x3a ,0x20 ,0x74 ,0x65
,0x78 ,0x74 ,0x2f ,0x68 ,0x74 ,0x6d ,0x6c ,0x0a ,0x0a ,0x3c ,0x21 ,0x44 ,0x4f ,0x43 ,0x54 ,0x59
,0x50 ,0x45 ,0x20 ,0x68 ,0x74 ,0x6d ,0x6c ,0x3e ,0x0a ,0x3c ,0x68 ,0x74 ,0x6d ,0x6c ,0x3e ,0x0a
,0x3c ,0x68 ,0x65 ,0x61 ,0x64 ,0x3e ,0x0a ,0x09 ,0x20 ,0x3c ,0x6d ,0x65 ,0x74 ,0x61 ,0x20 ,0x68
,0x74 ,0x74 ,0x70 ,0x2d ,0x65 ,0x71 ,0x75 ,0x69 ,0x76 ,0x3d ,0x22 ,0x43 ,0x6f ,0x6e ,0x74 ,0x65
,0x6e ,0x74 ,0x2d ,0x54 ,0x79 ,0x70 ,0x65 ,0x22 ,0x20 ,0x63 ,0x6f ,0x6e ,0x74 ,0x65 ,0x6e ,0x74
,0x3d ,0x22 ,0x74 ,0x65 ,0x78 ,0x74 ,0x2f ,0x68 ,0x74 ,0x6d ,0x6c ,0x3b ,0x20 ,0x63 ,0x68 ,0x61
,0x72 ,0x73 ,0x65 ,0x74 ,0x3d ,0x75 ,0x74 ,0x66 ,0x2d ,0x38 ,0x22 ,0x3e ,0x0a ,0x09 ,0x3c ,0x74
,0x69 ,0x74 ,0x6c ,0x65 ,0x3e ,0xc4 ,0x90 ,0x69 ,0xe1 ,0xbb ,0x81 ,0x75 ,0x20 ,0x6b ,0x68 ,0x69
,0xe1 ,0xbb ,0x83 ,0x6e ,0x20 ,0x74 ,0x68 ,0x69 ,0xe1 ,0xba ,0xbf ,0x74 ,0x20 ,0x62 ,0xe1 ,0xbb
,0x8b ,0x3c ,0x2f ,0x74 ,0x69 ,0x74 ,0x6c ,0x65 ,0x3e ,0x0a ,0x09 ,0x3c ,0x6d ,0x65 ,0x74 ,0x61
,0x20 ,0x6e ,0x61 ,0x6d ,0x65 ,0x3d ,0x22 ,0x76 ,0x69 ,0x65 ,0x77 ,0x70 ,0x6f ,0x72 ,0x74 ,0x22
,0x20 ,0x63 ,0x6f ,0x6e ,0x74 ,0x65 ,0x6e ,0x74 ,0x3d ,0x22 ,0x77 ,0x69 ,0x64 ,0x74 ,0x68 ,0x3d
,0x64 ,0x65 ,0x76 ,0x69 ,0x63 ,0x65 ,0x2d ,0x77 ,0x69 ,0x64 ,0x74 ,0x68 ,0x2c ,0x20 ,0x69 ,0x6e
,0x69 ,0x74 ,0x69 ,0x61 ,0x6c ,0x2d ,0x73 ,0x63 ,0x61 ,0x6c ,0x65 ,0x3d ,0x31 ,0x22 ,0x3e ,0x0a
,0x09 ,0x3c ,0x73 ,0x74 ,0x79 ,0x6c ,0x65 ,0x3e ,0x0a ,0x09 ,0x09 ,0x2e ,0x62 ,0x7b ,0x77 ,0x69
,0x64 ,0x74 ,0x68 ,0x3a ,0x20 ,0x31 ,0x30 ,0x30 ,0x70 ,0x78 ,0x3b ,0x68 ,0x65 ,0x69 ,0x67 ,0x68
,0x74 ,0x3a ,0x20 ,0x34 ,0x30 ,0x70 ,0x78 ,0x3b ,0x66 ,0x6f ,0x6e ,0x74 ,0x2d ,0x73 ,0x69 ,0x7a
,0x65 ,0x3a ,0x20 ,0x32 ,0x31 ,0x70 ,0x78 ,0x3b ,0x63 ,0x6f ,0x6c ,0x6f ,0x72 ,0x3a ,0x20 ,0x23
,0x46 ,0x46 ,0x46 ,0x3b ,0x62 ,0x61 ,0x63 ,0x6b ,0x67 ,0x72 ,0x6f ,0x75 ,0x6e ,0x64 ,0x2d ,0x63
,0x6f ,0x6c ,0x6f ,0x72 ,0x3a ,0x23 ,0x34 ,0x63 ,0x61 ,0x66 ,0x35 ,0x30 ,0x3b ,0x62 ,0x6f ,0x72
,0x64 ,0x65 ,0x72 ,0x2d ,0x72 ,0x61 ,0x64 ,0x69 ,0x75 ,0x73 ,0x3a ,0x20 ,0x31 ,0x30 ,0x70 ,0x78
,0x3b ,0x7d ,0x0a ,0x09 ,0x09 ,0x2e ,0x74 ,0x7b ,0x77 ,0x69 ,0x64 ,0x74 ,0x68 ,0x3a ,0x20 ,0x31
,0x30 ,0x30 ,0x70 ,0x78 ,0x3b ,0x68 ,0x65 ,0x69 ,0x67 ,0x68 ,0x74 ,0x3a ,0x20 ,0x34 ,0x30 ,0x70
,0x78 ,0x3b ,0x66 ,0x6f ,0x6e ,0x74 ,0x2d ,0x73 ,0x69 ,0x7a ,0x65 ,0x3a ,0x20 ,0x32 ,0x31 ,0x70
,0x78 ,0x3b ,0x63 ,0x6f ,0x6c ,0x6f ,0x72 ,0x3a ,0x20 ,0x23 ,0x46 ,0x46 ,0x46 ,0x3b ,0x62 ,0x61
,0x63 ,0x6b ,0x67 ,0x72 ,0x6f ,0x75 ,0x6e ,0x64 ,0x2d ,0x63 ,0x6f ,0x6c ,0x6f ,0x72 ,0x3a ,0x23
,0x66 ,0x34 ,0x34 ,0x33 ,0x33 ,0x36 ,0x3b ,0x62 ,0x6f ,0x72 ,0x64 ,0x65 ,0x72 ,0x2d ,0x72 ,0x61
,0x64 ,0x69 ,0x75 ,0x73 ,0x3a ,0x20 ,0x31 ,0x30 ,0x70 ,0x78 ,0x3b ,0x7d ,0x0a ,0x09 ,0x3c ,0x2f
,0x73 ,0x74 ,0x79 ,0x6c ,0x65 ,0x3e ,0x0a ,0x3c ,0x2f ,0x68 ,0x65 ,0x61 ,0x64 ,0x3e ,0x0a ,0x3c
,0x62 ,0x6f ,0x64 ,0x79 ,0x3e ,0x0a ,0x3c ,0x64 ,0x69 ,0x76 ,0x20 ,0x73 ,0x74 ,0x79 ,0x6c ,0x65
,0x3d ,0x22 ,0x77 ,0x69 ,0x64 ,0x74 ,0x68 ,0x3a ,0x20 ,0x33 ,0x33 ,0x30 ,0x70 ,0x78 ,0x3b ,0x68
,0x65 ,0x69 ,0x67 ,0x68 ,0x74 ,0x3a ,0x20 ,0x61 ,0x75 ,0x74 ,0x6f ,0x3b ,0x6d ,0x61 ,0x72 ,0x67
,0x69 ,0x6e ,0x3a ,0x20 ,0x30 ,0x20 ,0x61 ,0x75 ,0x74 ,0x6f ,0x3b ,0x6d ,0x61 ,0x72 ,0x67 ,0x69
,0x6e ,0x2d ,0x74 ,0x6f ,0x70 ,0x3a ,0x20 ,0x37 ,0x30 ,0x70 ,0x78 ,0x22 ,0x3e ,0x0a ,0x3c ,0x68
,0x31 ,0x20 ,0x61 ,0x6c ,0x69 ,0x67 ,0x6e ,0x3d ,0x22 ,0x63 ,0x65 ,0x6e ,0x74 ,0x65 ,0x72 ,0x22
,0x3e ,0xc4 ,0x90 ,0x69 ,0xe1 ,0xbb ,0x81 ,0x75 ,0x20 ,0x6b ,0x68 ,0x69 ,0xe1 ,0xbb ,0x83 ,0x6e
,0x20 ,0x74 ,0x68 ,0x69 ,0xe1 ,0xba ,0xbf ,0x74 ,0x20 ,0x62 ,0xe1 ,0xbb ,0x8b ,0x20 ,0x71 ,0x75
,0x61 ,0x20 ,0x57 ,0x49 ,0x46 ,0x49 ,0x3c ,0x2f ,0x68 ,0x31 ,0x3e ,0x0a ,0x09 ,0x3c ,0x74 ,0x61
,0x62 ,0x6c ,0x65 ,0x20 ,0x61 ,0x6c ,0x69 ,0x67 ,0x6e ,0x3d ,0x22 ,0x63 ,0x65 ,0x6e ,0x74 ,0x65
,0x72 ,0x22 ,0x3e ,0x0a ,0x09 ,0x09 ,0x3c ,0x74 ,0x72 ,0x3e ,0x0a ,0x09 ,0x09 ,0x09 ,0x3c ,0x74
,0x64 ,0x3e ,0x3c ,0x61 ,0x20 ,0x68 ,0x72 ,0x65 ,0x66 ,0x3d ,0x27 ,0x2f ,0x62 ,0x61 ,0x74 ,0x31
,0x27 ,0x3e ,0x3c ,0x62 ,0x75 ,0x74 ,0x74 ,0x6f ,0x6e ,0x20 ,0x63 ,0x6c ,0x61 ,0x73 ,0x73 ,0x3d
,0x27 ,0x62 ,0x27 ,0x3e ,0x42 ,0xe1 ,0xba ,0xad ,0x74 ,0x20 ,0x31 ,0x3c ,0x2f ,0x62 ,0x75 ,0x74
,0x74 ,0x6f ,0x6e ,0x3e ,0x3c ,0x2f ,0x61 ,0x3e ,0x3c ,0x74 ,0x64 ,0x3e ,0x0a ,0x09 ,0x09 ,0x09
,0x3c ,0x74 ,0x64 ,0x3e ,0x3c ,0x61 ,0x20 ,0x68 ,0x72 ,0x65 ,0x66 ,0x3d ,0x27 ,0x2f ,0x74 ,0x61
,0x74 ,0x31 ,0x27 ,0x3e ,0x3c ,0x62 ,0x75 ,0x74 ,0x74 ,0x6f ,0x6e ,0x20 ,0x63 ,0x6c ,0x61 ,0x73
,0x73 ,0x3d ,0x27 ,0x74 ,0x27 ,0x3e ,0x54 ,0xe1 ,0xba ,0xaf ,0x74 ,0x20 ,0x31 ,0x3c ,0x2f ,0x62
,0x75 ,0x74 ,0x74 ,0x6f ,0x6e ,0x3e ,0x3c ,0x2f ,0x61 ,0x3e ,0x3c ,0x74 ,0x64 ,0x3e ,0x0a ,0x09
,0x20 ,0x20 ,0x20 ,0x20 ,0x3c ,0x74 ,0x72 ,0x3e ,0x0a ,0x09 ,0x20 ,0x20 ,0x20 ,0x20 ,0x3c ,0x74
,0x72 ,0x3e ,0x0a ,0x09 ,0x09 ,0x09 ,0x3c ,0x74 ,0x64 ,0x3e ,0x3c ,0x61 ,0x20 ,0x68 ,0x72 ,0x65
,0x66 ,0x3d ,0x27 ,0x2f ,0x62 ,0x61 ,0x74 ,0x32 ,0x27 ,0x3e ,0x3c ,0x62 ,0x75 ,0x74 ,0x74 ,0x6f
,0x6e ,0x20 ,0x63 ,0x6c ,0x61 ,0x73 ,0x73 ,0x3d ,0x27 ,0x62 ,0x27 ,0x3e ,0x42 ,0xe1 ,0xba ,0xad
,0x74 ,0x20 ,0x32 ,0x3c ,0x2f ,0x62 ,0x75 ,0x74 ,0x74 ,0x6f ,0x6e ,0x3e ,0x3c ,0x2f ,0x61 ,0x3e
,0x3c ,0x74 ,0x64 ,0x3e ,0x0a ,0x09 ,0x09 ,0x09 ,0x3c ,0x74 ,0x64 ,0x3e ,0x3c ,0x61 ,0x20 ,0x68
,0x72 ,0x65 ,0x66 ,0x3d ,0x27 ,0x2f ,0x74 ,0x61 ,0x74 ,0x32 ,0x27 ,0x3e ,0x3c ,0x62 ,0x75 ,0x74
,0x74 ,0x6f ,0x6e ,0x20 ,0x63 ,0x6c ,0x61 ,0x73 ,0x73 ,0x3d ,0x27 ,0x74 ,0x27 ,0x3e ,0x54 ,0xe1
,0xba ,0xaf ,0x74 ,0x20 ,0x32 ,0x3c ,0x2f ,0x62 ,0x75 ,0x74 ,0x74 ,0x6f ,0x6e ,0x3e ,0x3c ,0x2f
,0x61 ,0x3e ,0x3c ,0x74 ,0x64 ,0x3e ,0x0a ,0x09 ,0x20 ,0x20 ,0x20 ,0x20 ,0x3c ,0x74 ,0x72 ,0x3e
,0x0a ,0x09 ,0x20 ,0x20 ,0x20 ,0x20 ,0x3c ,0x74 ,0x72 ,0x3e ,0x0a ,0x09 ,0x09 ,0x09 ,0x3c ,0x74
,0x64 ,0x3e ,0x3c ,0x61 ,0x20 ,0x68 ,0x72 ,0x65 ,0x66 ,0x3d ,0x27 ,0x2f ,0x62 ,0x61 ,0x74 ,0x33
,0x27 ,0x3e ,0x3c ,0x62 ,0x75 ,0x74 ,0x74 ,0x6f ,0x6e ,0x20 ,0x63 ,0x6c ,0x61 ,0x73 ,0x73 ,0x3d
,0x27 ,0x62 ,0x27 ,0x3e ,0x42 ,0xe1 ,0xba ,0xad ,0x74 ,0x20 ,0x33 ,0x3c ,0x2f ,0x62 ,0x75 ,0x74
,0x74 ,0x6f ,0x6e ,0x3e ,0x3c ,0x2f ,0x61 ,0x3e ,0x3c ,0x74 ,0x64 ,0x3e ,0x0a ,0x09 ,0x09 ,0x09
,0x3c ,0x74 ,0x64 ,0x3e ,0x3c ,0x61 ,0x20 ,0x68 ,0x72 ,0x65 ,0x66 ,0x3d ,0x27 ,0x2f ,0x74 ,0x61
,0x74 ,0x33 ,0x27 ,0x3e ,0x3c ,0x62 ,0x75 ,0x74 ,0x74 ,0x6f ,0x6e ,0x20 ,0x63 ,0x6c ,0x61 ,0x73
,0x73 ,0x3d ,0x27 ,0x74 ,0x27 ,0x3e ,0x54 ,0xe1 ,0xba ,0xaf ,0x74 ,0x20 ,0x33 ,0x3c ,0x2f ,0x62
,0x75 ,0x74 ,0x74 ,0x6f ,0x6e ,0x3e ,0x3c ,0x2f ,0x61 ,0x3e ,0x3c ,0x74 ,0x64 ,0x3e ,0x0a ,0x09
,0x20 ,0x20 ,0x20 ,0x20 ,0x3c ,0x74 ,0x72 ,0x3e ,0x0a ,0x09 ,0x20 ,0x20 ,0x20 ,0x20 ,0x3c ,0x74
,0x72 ,0x3e ,0x0a ,0x09 ,0x09 ,0x09 ,0x3c ,0x74 ,0x64 ,0x3e ,0x3c ,0x61 ,0x20 ,0x68 ,0x72 ,0x65
,0x66 ,0x3d ,0x27 ,0x2f ,0x62 ,0x61 ,0x74 ,0x34 ,0x27 ,0x3e ,0x3c ,0x62 ,0x75 ,0x74 ,0x74 ,0x6f
,0x6e ,0x20 ,0x63 ,0x6c ,0x61 ,0x73 ,0x73 ,0x3d ,0x27 ,0x62 ,0x27 ,0x3e ,0x42 ,0xe1 ,0xba ,0xad
,0x74 ,0x20 ,0x34 ,0x3c ,0x2f ,0x62 ,0x75 ,0x74 ,0x74 ,0x6f ,0x6e ,0x3e ,0x3c ,0x2f ,0x61 ,0x3e
,0x3c ,0x74 ,0x64 ,0x3e ,0x0a ,0x09 ,0x09 ,0x09 ,0x3c ,0x74 ,0x64 ,0x3e ,0x3c ,0x61 ,0x20 ,0x68
,0x72 ,0x65 ,0x66 ,0x3d ,0x27 ,0x2f ,0x74 ,0x61 ,0x74 ,0x34 ,0x27 ,0x3e ,0x3c ,0x62 ,0x75 ,0x74
,0x74 ,0x6f ,0x6e ,0x20 ,0x63 ,0x6c ,0x61 ,0x73 ,0x73 ,0x3d ,0x27 ,0x74 ,0x27 ,0x3e ,0x54 ,0xe1
,0xba ,0xaf ,0x74 ,0x20 ,0x34 ,0x3c ,0x2f ,0x62 ,0x75 ,0x74 ,0x74 ,0x6f ,0x6e ,0x3e ,0x3c ,0x2f
,0x61 ,0x3e ,0x3c ,0x74 ,0x64 ,0x3e ,0x0a ,0x09 ,0x20 ,0x20 ,0x20 ,0x20 ,0x3c ,0x74 ,0x72 ,0x3e
,0x09 ,0x0a ,0x09 ,0x3c ,0x2f ,0x74 ,0x61 ,0x62 ,0x6c ,0x65 ,0x3e ,0x0a ,0x3c ,0x2f ,0x64 ,0x69
,0x76 ,0x3e ,0x0a ,0x3c ,0x2f ,0x62 ,0x6f ,0x64 ,0x79 ,0x3e ,0x0a ,0x3c ,0x2f ,0x68 ,0x74 ,0x6d
,0x6c ,0x3e
};

const uint8_t web_page2[]=
{
"HTTP/1.1 200 OK\r\n"          \
"Content-Type: text/html\r\n"  \
"<h1>IoT47.com - ENC28J60 Tutorual</h1>" \
};

uint8_t HTTP_get_status(void)
{
  return status;
}
void HTTP_set_status(uint8_t s)
{
   status=s;
}
uint32_t HTTP_get_Sequence_Number(void)
{
 return Sequence_Number;
}
void HTTP_set_Sequence_Number(uint32_t SequenceN)
{
 Sequence_Number = SequenceN;
}
void HTTP_pack_init(void)
{
   status=1;  //bat dau gui goi tin http dau tien
   data_num=0;
}
uint8_t HTTP_get_data_num(uint8_t** data,uint16_t* data_length)
{
   if(data_num >= sizeof(web_page)) //da gui xong data, dong ket noi
   {
      //UART_putString("da gui xong tap tin html\r\n");
      return 1;//end
   }
   else if( (sizeof(web_page) - data_num) > 458 ) //neu du lieu can gui > 458  (con gui tiep nua)
      *data_length=458;
   else if( (sizeof(web_page) - data_num) <= 458 ) //neu du lieu can gui <= 458 (gui lan cuoi)
      *data_length =  sizeof(web_page)  - data_num;
   *data=(uint8_t *)web_page+data_num;
   data_num+=(*data_length);
   return 0;
}
//--------------------------------------------------

